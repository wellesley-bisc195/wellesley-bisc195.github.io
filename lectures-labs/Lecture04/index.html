<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_lanyon.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="/css/stackoverflow-light.css"> <link rel=icon  href="/assets/favicon.png"> <title>Free play</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>A theme adapted from <a href="http://lanyon.getpoole.com/" target=_blank >Lanyon</a>.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/syllabus/">Syllabus</a> <a class="sidebar-nav-item " href="/lessons/">Lessons</a> <a class="sidebar-nav-item " href="/lectures-labs/">Lectures & Labs</a> <a class="sidebar-nav-item " href="/assignments/">Assignments</a> </nav> <div class=sidebar-item > <p>&copy; Kevin Bonham, PhD.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/" title=Home >Wellesley College - BISC189</a> <small>Essential Skills for Computational Biology</small> </h3> </div> </div> <div class="container content"> <div class=franklin-content > <h1 id=a_hreflectures-labslecture04lecture_4_-_free_play ><a href="#a_hreflectures-labslecture04lecture_4_-_free_play" class=header-anchor ><a href="/lectures-labs/Lecture04">Lecture 4 - Free play</a></a></h1> <div class=badges ><img src="https://img.shields.io/badge/Date-2021--06--18-orange?style&#61;for-the-badge" alt=lesson4date  /> <a href="#"><img src="https://img.shields.io/badge/Slides-NA-blue?style&#61;for-the-badge" alt="Lecture4 slides" /></a></div> <div class=colbox-blue ><div class=title ><strong>Note</strong></div> <p>Kevin is out of town, so there will be no lecture today. Use class time to work on today&#39;s lab, or get caught up on assignments. The lecture Zoom link is open if you want to meet up with fellow students to work together on labs, or ask eachother questions.</p></div> <h2 id=lab_4_-_needleman-wunsch_aligner_part_2 ><a href="#lab_4_-_needleman-wunsch_aligner_part_2" class=header-anchor >Lab 4 - Needleman-Wunsch Aligner, Part 2</a></h2> <p>In the <a href="../Lecture03/#lab_3_-_needleman-wunsch_aligner_part_1">last lab</a>, we built some scoring functions for a Needleman-wunsch alighnment algorithm. Today, we&#39;re going to build a function that will build and score an alignment matrix.</p> <div class=colbox-blue ><div class=title ><strong>Note</strong></div> <p>This lab will be quite challenging if you have not yet completed lesson 5, where you learn about writing loops. At minimum, you should have read the chapters of the book assigned for lesson 5.</p></div> <h3 id=continuing_from_lab_3_-_submission_guidelines ><a href="#continuing_from_lab_3_-_submission_guidelines" class=header-anchor >Continuing from Lab 3 - submission guidelines</a></h3> <p>You should have completed Lab 3 before you get stared on Lab 4. This lab will require a separate pull request from Lab 3, and there are several ways to do this, depending on how you completed Lab 3.</p> <p>If you submitted your own PR for Lab 3 and would like to do the same for Lab 4, or you submitted a PR with a partner and would like to continue to work together, this is the easiest case. Simply check out a new branch from where you left off &#40;<code>git checkout -b lab4</code>&#41;, push it to github &#40;<code>git push -u origin lab4</code>&#41;</p> <p>If you previously worked with a partner, and want to continue on your own, particularly if you weren&#39;t the one committing, it&#39;s a bit more complicated. Your best bet is to do the following &#40;see the beginning of the last two labs for more details&#41;:</p> <ol> <li><p>Fork the main repo at https://github.com/wellesley-bisc195/BISC195Labs</p> <li><p>Clone your fork to your own computer</p> <li><p>Add your partner&#39;s fork as a remote. Eg if I were your partner, you would do <code>git remote add kevin https://github.com/kescobo/BISC195Labs.git</code></p> <li><p>&quot;Fetch&quot; your partner&#39;s repo - this downloads the information, but doesn&#39;t take any action. In the above example, you&#39;d write <code>git fetch kevin</code>.</p> <li><p>Check out the lab3 branch. If the branch was called <code>ksb123</code>, you&#39;d do <code>git checkout ksb123</code>.</p> <li><p>Start a new branch off of of this one </p> </ol> <pre><code class=language-sh >&#36; git branch lab4-branch
&#36; git checkout lab4-branch</code></pre> <ol start=7 > <li><p>Once you&#39;ve made changes, commit and push them.</p> </ol> <h3 id=intro_to_matrix_-_a_2d_array ><a href="#intro_to_matrix_-_a_2d_array" class=header-anchor >Intro to Matrix - a 2D array</a></h3> <p>A matrix is a 2 dimensional &quot;array&quot; - you&#39;ll learn more about arrays in <a href="/lessons/Lesson05">Lesson 6</a>, but for now, think of it like a table in excel or google sheets with rows and columns.</p> <p>The <em>first</em> dimension of a <code>Matrix</code> is the row number, and the <em>second</em> dimension is the column number. you can access the value of a given position using &quot;indexing&quot; - in julia, the syntax for that accessing row <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> and column <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> from matrix <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> is <code>M&#91;i, j&#93;</code>.</p> <p>For example, the following is a matrix with 3 columns and 4 rows &#40;no need to understand the first line&#41;:</p> <pre><code class=language-julia-repl >julia&gt; M &#61; collect&#40;reshape&#40;1:12, 4, 3&#41;&#41;
4×3 Matrix&#123;Int64&#125;:
 1  5   9
 2  6  10
 3  7  11
 4  8  12</code></pre> <p>If I want to access the 3rd row, 2nd column, I can do:</p> <pre><code class=language-julia-repl >julia&gt; M&#91;3,2&#93;
7</code></pre> <p>You can also re-assign the value at a given position, using the same assignment syntax as for variables, eg:</p> <pre><code class=language-julia-repl >julia&gt; M&#91;3,2&#93; &#61; 42
42

julia&gt; m # note where the 7 used to be
4×3 Matrix&#123;Int64&#125;:
 1   5   9
 2   6  10
 3  42  11
 4   8  12</code></pre> <p>The last thing you need to know is that you can create a matrix with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span> columns and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> rows that&#39;s filled with zeros of type <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> using <code>zeros&#40;T, r, c&#41;</code>, eg</p> <pre><code class=language-julia-repl >julia&gt; zeros&#40;Int, 4,3&#41;
4×3 Matrix&#123;Int64&#125;:
 0  0  0
 0  0  0
 0  0  0
 0  0  0</code></pre> <p>OK, let&#39;s get started&#33;</p> <h3 id=step_1_-_make_a_matrix ><a href="#step_1_-_make_a_matrix" class=header-anchor >Step 1 - Make a matrix</a></h3> <p>First, let&#39;s write a function that sets up an alignment matrix for our NW aligner.</p> <div class=colbox-orange ><div class=title >Checking Question</div> <p>Given two sequences, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, with lengths <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">l_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">l_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, what size should the resulting scoring matrix be?</p> <p>Answer below<sup id="fnref:cq1ans"><a href="#fndef:cq1ans" class=fnref >[1]</a></sup></p></div> <p>Write a function called <code>nwsetupmatrix&#40;&#41;</code> that takes 2 sequences and generates a scoring matrix of the correct size. The matrix should start out being filled with zeros. Don&#39;t forget to add it to your package exports in <code>src/BISC195Labs.jl</code>&#33;</p> <p>Add the following to <code>test/runtests.jl</code> in your BISC195Labs repo:</p> <pre><code class=language-julia >@testset &quot;Scoring matrix setup&quot; begin
    m &#61; nwsetupmatrix&#40;&quot;AATT&quot;, &quot;AAGTT&quot;&#41;
    
    @test m isa Matrix
    @test size&#40;m, 1&#41; &#61;&#61; 5
    @test size&#40;m, 2&#41; &#61;&#61; 6
    @test all&#40;&#61;&#61;&#40;0&#41;, m&#41;
end</code></pre> <p>This testset should pass if you made <code>nwsetupmatrix&#40;&#41;</code> correctly.</p> <h3 id=step_2_-_more_matrix_setup ><a href="#step_2_-_more_matrix_setup" class=header-anchor >Step 2 - More Matrix setup</a></h3> <p>Actually, you can do more during the setup phase without actually comparing the sequences.</p> <ol> <li><p>Position <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mo stretchy=false >(</mo><mn>1</mn><mo separator=true >,</mo><mn>1</mn><mo stretchy=false >)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">M_{(1,1)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> is always <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></p> <li><p>Positions <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mo stretchy=false >(</mo><mn>1</mn><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">M_{(1,j)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> for all <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j &gt; 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> are <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">(j-1)g</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> is the gap score</p> <li><p>Positions <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mn>1</mn><mo stretchy=false >)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">M_{(i,1)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> for all <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i &gt; 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> are <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">(i-1)g</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> is the gap score</p> </ol> <p>Another way to say that is that you can fill the first row and column with the gap score times the row or column index minus 1.</p> <p>For example, if your gap score is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span>, and you have a <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">4\times5</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >4</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span></span></span></span> matrix, you can set up your matrix like this:</p> <pre><code class=language-julia-repl >julia&gt; M
4×5 Matrix&#123;Int64&#125;:
  0  -2  -4  -6  -8
 -2   0   0   0   0
 -4   0   0   0   0
 -6   0   0   0   0

julia&gt; M&#91;1,1&#93;
0

julia&gt; M&#91;1,2&#93;
-2

julia&gt; M&#91;1,5&#93;
-8</code></pre> <p>Now, add a keyword argument to <code>nwsetupmatrix&#40;&#41;</code> that allows you to give it a gap score, with a default of <code>-1</code>. Add code that fills in the scores for the first row and column.</p> <p>All of your tests should still work, except for the last one. Here are some more:</p> <pre><code class=language-julia >@testset &quot;Scoring matrix setup&quot; begin
    m &#61; nwsetupmatrix&#40;&quot;AATT&quot;, &quot;AAGTT&quot;&#41;
    
    @test m isa Matrix
    @test size&#40;m, 1&#41; &#61;&#61; 5
    @test size&#40;m, 2&#41; &#61;&#61; 6
    # @test all&#40;&#61;&#61;&#40;0&#41;, m&#41; # this no longer works

    @test m&#91;1,1&#93; &#61;&#61; 0

    # I wrote these next two in a way that&#39;s slightly opaque, since writing it in a clear way
    # would make it obvious how to write the function in the first place.
    # If you want to know how it works, ask me on Zulip,
    # or if you want to investigate yourself, break it down into individual expressions
    @test all&#40;m&#91;2:end,1&#93; .&#61;&#61; &#40;-1 .* &#40;1:&#40;size&#40;m,1&#41;-1&#41;&#41;&#41;&#41; # test first column
    @test all&#40;m&#91;1,2:end&#93; .&#61;&#61; &#40;-1 .* &#40;1:&#40;size&#40;m,2&#41;-1&#41;&#41;&#41;&#41; # test first row

    m2 &#61; nwsetupmatrix&#40;&quot;AATT&quot;, &quot;AAGTT&quot;; gap&#61;-2&#41;
    
    @test m2 isa Matrix
    @test size&#40;m2, 1&#41; &#61;&#61; 5
    @test size&#40;m2, 2&#41; &#61;&#61; 6

    @test m2&#91;1,1&#93; &#61;&#61; 0
    @test all&#40;m2&#91;2:end,1&#93; .&#61;&#61; &#40;-2 .* &#40;1:&#40;size&#40;m2,1&#41;-1&#41;&#41;&#41;&#41; # test first column
    @test all&#40;m2&#91;1,2:end&#93; .&#61;&#61; &#40;-2 .* &#40;1:&#40;size&#40;m2,2&#41;-1&#41;&#41;&#41;&#41; # test first row
end</code></pre> <h3 id=step_3_-_score_the_matrix ><a href="#step_3_-_score_the_matrix" class=header-anchor >Step 3 - Score the matrix</a></h3> <p>Now that you can set up the matrix, it&#39;s time to score it. Write a function that takes two sequences, and uses keyword arguments to set the <code>match</code>, <code>mismatch</code>, and <code>gap</code> scores, and then scores the remaining cells.</p> <p>A couple of pointers to get you started:</p> <ol> <li><p>If your matrix is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>, your row index is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>, and your column index is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>, recall that the score for a cell is the largest of:</p> <ol> <li><p>the score coming from above it &#40;a gap&#41;, that is <code>m&#91;i-1, j&#93;</code></p> <li><p>the score coming from the left &#40;a gap&#41;, that is <code>m&#91;i, j-1&#93;</code></p> <li><p>the score coming from the diagonal &#40;a match or mismatch&#41;, that is <code>m&#91;i-1, j-1&#93;</code></p> </ol> <li><p>The <code>max&#40;&#41;</code> function takes any number of arguments, and returns the largest.</p> </ol> <pre><code class=language-julia-repl >julia&gt; max&#40;1,5,3,6,-1,5&#41;
       6</code></pre> <ol start=3 > <li><p>To get the letter of a <code>String</code> at a given position, you can index it like a vector. That is, the 3rd letter of <code>s</code> can be pulled out with <code>s&#91;3&#93;</code>. Just keep in mind that the 3rd letter of sequence1 is actually the 4th row. Keep your indices straight&#33; &quot;Off-by-one&quot; errors are pretty common in programming.</p> <li><p>For now, don&#39;t bother to keep track of where a given score came from, we&#39;ll deal with that in the next lab.</p> </ol> <p>I&#39;ll get it started for you:</p> <pre><code class=language-julia >function nwscorematrix&#40;seq1, seq2; match&#61;1, mismatch&#61;-1, gap&#61;-1&#41;
    scoremat &#61; nwsetupmatrix&#40;seq1, seq2; gap&#61;gap&#41;
    for i in 2:size&#40;scoremat, 1&#41; # iterate through row indices
        for j in 2:size&#40;scoremat, 2&#41; # iterate through column indices
            @info &quot;scoring Row &#36;i, Column &#36;j&quot;
            # your code here ... 
        end
    end
    return scoremat
end</code></pre> <p>Write a test to see if you get the same scoring matrix for the sequences in the youtube video from the last lecture.</p> <pre><code class=language-julia >julia&gt; nwscorematrix&#40;&quot;ACGAT&quot;, &quot;AGGT&quot;&#41;
6×5 Matrix&#123;Int64&#125;:
  0  -1  -2  -3  -4
 -1   1   0  -1  -2
 -2   0   0  -1  -2
 -3  -1   1   1   0
 -4  -2   0   0   0
 -5  -3  -1  -1   1</code></pre> <table class=fndef  id="fndef:cq1ans"> <tr> <td class=fndef-backref ><a href="#fnref:cq1ans">[1]</a> <td class=fndef-content >The matrix should be <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>l</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo><mo>×</mo><mo stretchy=false >(</mo><msub><mi>l</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(l_1 + 1) \times (l_2 + 1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span>. Note that it doesn&#39;t matter which sequence consititutes the rows, and which the columns, but be consistent&#33; Since in julia dimension 1 is the row index, I suggest making <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be the vertical. </table> <div class=page-foot > <div class=copyright > &copy; Kevin Bonham, PhD. Last modified: June 22, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <script src="/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script> <label for=sidebar-checkbox  class=sidebar-toggle ></label>